---
/**
 * Participate Page — EDI McGill
 *
 * 2×2 grid of participation cards with accent top borders.
 * Per-card accent palette:
 *   Share Your Story  → Plum   (#944E63)
 *   Give Feedback     → Teal   (#3B8595)
 *   Volunteer         → Amber  (#C27A3A)
 *   Join a Committee  → Indigo (#4A5899)
 *
 * Canvas: warm off-white (#FAFAF8), dark: #1B1D21
 */
import BaseLayout from '@/layouts/BaseLayout'

const title = 'Get Involved'
const description = 'Join EDI McGill - submit your story, share feedback, or volunteer with us'
---

<BaseLayout title={title} description={description}>
	<div class='part-canvas'>
		<!-- ── 1. Hero banner ── -->
		<div class='part-banner'>
			<img
				src='/assets/participate-banner.jpg'
				alt='Painted silhouettes of diverse people in vibrant colours'
				class='part-banner-img'
				loading='eager'
			/>
			<div class='part-banner-overlay'></div>
			<div class='part-banner-text'>
				<h1 class='part-title'>Get Involved</h1>
				<p class='part-sub'>How do you want to show up?</p>
				<p class='part-micro'>Start anywhere. Every path matters.</p>
			</div>
		</div>

		<!-- ── 2. Participation grid ── -->
		<section class='part-grid-wrap' aria-label='Ways to participate'>
			<div class='part-grid'>
				<article class='pcard pcard-1' tabindex='0'>
					<div class='pcard-accent'></div>
					<div class='pcard-inner'>
						<div class='pcard-header'>
							<svg
								class='pcard-icon'
								viewBox='0 0 24 24'
								fill='none'
								stroke='currentColor'
								stroke-width='1.8'
								stroke-linecap='round'
								stroke-linejoin='round'
								aria-hidden='true'
							>
								<path d='M12 20h9'></path><path
									d='M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z'></path>
							</svg>
							<h3 class='pcard-title'>Share Your Story</h3>
						</div>
						<p class='pcard-desc'>
							Your narrative helps others see the world differently. Personal stories create bridges
							of understanding across communities.
						</p>
						<span class='pcard-meta'>Anonymous option &middot; 5 min</span>
						<span class='pcard-reveal'>You can skip any question</span>
					</div>
				</article>

				<article class='pcard pcard-2' tabindex='0'>
					<div class='pcard-accent'></div>
					<div class='pcard-inner'>
						<div class='pcard-header'>
							<svg
								class='pcard-icon'
								viewBox='0 0 24 24'
								fill='none'
								stroke='currentColor'
								stroke-width='1.8'
								stroke-linecap='round'
								stroke-linejoin='round'
								aria-hidden='true'
							>
								<path d='M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z'></path>
							</svg>
							<h3 class='pcard-title'>Give Feedback</h3>
						</div>
						<p class='pcard-desc'>
							Your input shapes what we build next. Help us understand what matters most to you on
							campus.
						</p>
						<span class='pcard-meta'>Quick form &middot; 2 min</span>
						<span class='pcard-reveal'>Responses are reviewed weekly</span>
					</div>
				</article>

				<article class='pcard pcard-3' tabindex='0'>
					<div class='pcard-accent'></div>
					<div class='pcard-inner'>
						<div class='pcard-header'>
							<svg
								class='pcard-icon'
								viewBox='0 0 24 24'
								fill='none'
								stroke='currentColor'
								stroke-width='1.8'
								stroke-linecap='round'
								stroke-linejoin='round'
								aria-hidden='true'
							>
								<path
									d='M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z'
								></path>
							</svg>
							<h3 class='pcard-title'>Volunteer With Us</h3>
						</div>
						<p class='pcard-desc'>
							Hands-on work that makes campus more inclusive. Join events, mentor peers, or lead
							initiatives.
						</p>
						<span class='pcard-meta'>Flexible hours &middot; Join anytime</span>
						<span class='pcard-reveal'>No prior experience needed</span>
					</div>
				</article>

				<article class='pcard pcard-4' tabindex='0'>
					<div class='pcard-accent'></div>
					<div class='pcard-inner'>
						<div class='pcard-header'>
							<svg
								class='pcard-icon'
								viewBox='0 0 24 24'
								fill='none'
								stroke='currentColor'
								stroke-width='1.8'
								stroke-linecap='round'
								stroke-linejoin='round'
								aria-hidden='true'
							>
								<path d='M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2'></path><circle
									cx='9'
									cy='7'
									r='4'></circle><path d='M23 21v-2a4 4 0 0 0-3-3.87'></path><path
									d='M16 3.13a4 4 0 0 1 0 7.75'></path>
							</svg>
							<h3 class='pcard-title'>Join a Committee</h3>
						</div>
						<p class='pcard-desc'>
							Shape policy and advocate for change. Committees meet monthly to advance equity on
							campus.
						</p>
						<span class='pcard-meta'>Monthly meetings &middot; All welcome</span>
						<span class='pcard-reveal'>Open to students &amp; staff</span>
					</div>
				</article>
			</div>
		</section>

		<!-- ── 3. Support block ── -->
		<div class='part-support'>
			<p class='part-support-line'>Not sure where to start? Choose what feels easiest today.</p>
			<div class='part-support-links'>
				<a href='/resources' class='part-support-link'>Explore case studies</a>
				<a href='/stories' class='part-support-link'>Read stories</a>
				<a href='/about' class='part-support-link'>Contact us</a>
			</div>
		</div>

		<!-- ── Quiz section ── -->
		<section class='part-section part-quiz-section'>
			<h2 class='part-section-title'>Test your EDI knowledge</h2>
			<p class='part-quiz-sub'>Explore real scenarios and discover how you would respond.</p>

			<div class='part-quiz-container'>
				<div class='part-quiz-inner'>
					<div class='part-quiz-progress-wrap'>
						<div class='part-quiz-progress-meta'>
							<span>Question <span class='current-question'>1</span> of 3</span>
							<span class='progress-percentage'>33%</span>
						</div>
						<div class='part-quiz-track'>
							<div class='quiz-progress part-quiz-bar' style='width: 33.33%'></div>
						</div>
					</div>

					<div class='question active' data-question='1'>
						<h3 class='part-quiz-heading'>Scenario: Inclusive Group Work</h3>
						<p class='part-quiz-desc'>
							You're leading a group project and notice one international student is quiet during
							meetings. They seem hesitant to share ideas. What's your best approach?
						</p>
						<div class='part-quiz-options'>
							<button class='option-btn part-option' data-answer='a'>
								<span class='part-option-letter'>A</span>
								<span>Directly call on them in the next meeting to contribute</span>
							</button>
							<button class='option-btn part-option' data-answer='b'>
								<span class='part-option-letter'>B</span>
								<span
									>Have a private conversation to understand their preferred communication style</span
								>
							</button>
							<button class='option-btn part-option' data-answer='c'>
								<span class='part-option-letter'>C</span>
								<span>Assume they're not interested and continue without their input</span>
							</button>
							<button class='option-btn part-option' data-answer='d'>
								<span class='part-option-letter'>D</span>
								<span>Provide multiple ways to contribute (speaking, writing, visual)</span>
							</button>
						</div>
						<div class='feedback part-feedback hidden'></div>
					</div>

					<div class='question hidden' data-question='2'>
						<h3 class='part-quiz-heading'>Scenario: Cultural Celebrations</h3>
						<p class='part-quiz-desc'>
							Your department wants to host cultural celebrations. A colleague suggests only
							celebrating major holidays to save time. What do you recommend?
						</p>
						<div class='part-quiz-options'>
							<button class='option-btn part-option' data-answer='a'>
								<span class='part-option-letter'>A</span>
								<span>Agree — focus only on widely recognized holidays</span>
							</button>
							<button class='option-btn part-option' data-answer='b'>
								<span class='part-option-letter'>B</span>
								<span>Create a rotating monthly celebration featuring different cultures</span>
							</button>
							<button class='option-btn part-option' data-answer='c'>
								<span class='part-option-letter'>C</span>
								<span>Skip cultural celebrations entirely to avoid potential issues</span>
							</button>
							<button class='option-btn part-option' data-answer='d'>
								<span class='part-option-letter'>D</span>
								<span>Survey students to understand which celebrations are meaningful to them</span>
							</button>
						</div>
						<div class='feedback part-feedback hidden'></div>
					</div>

					<div class='question hidden' data-question='3'>
						<h3 class='part-quiz-heading'>Scenario: Microaggressions</h3>
						<p class='part-quiz-desc'>
							You witness a colleague make an insensitive comment to a graduate student from a
							marginalized group. The student looks uncomfortable. What should you do?
						</p>
						<div class='part-quiz-options'>
							<button class='option-btn part-option' data-answer='a'>
								<span class='part-option-letter'>A</span>
								<span>Ignore it — it's not your place to intervene</span>
							</button>
							<button class='option-btn part-option' data-answer='b'>
								<span class='part-option-letter'>B</span>
								<span>Publicly call out the colleague immediately and harshly</span>
							</button>
							<button class='option-btn part-option' data-answer='c'>
								<span class='part-option-letter'>C</span>
								<span
									>Gently redirect the conversation and check in with the student privately later</span
								>
							</button>
							<button class='option-btn part-option' data-answer='d'>
								<span class='part-option-letter'>D</span>
								<span>Wait to see if the student brings it up first</span>
							</button>
						</div>
						<div class='feedback part-feedback hidden'></div>
					</div>

					<div class='results hidden'>
						<div class='part-results-inner'>
							<h3 class='part-quiz-heading'>Quiz Complete!</h3>
							<p class='part-body-lead'>
								You scored <span class='score' style='color: #944E63; font-weight: 700;'>0</span> out
								of 3
							</p>
							<div class='results-message part-results-message'><p></p></div>
							<button class='restart-btn part-restart'>Retake Quiz</button>
						</div>
					</div>

					<div class='nav-buttons part-nav-buttons'>
						<button class='prev-btn part-nav-prev hidden'>Previous</button>
						<div class='flex-1'></div>
						<button class='next-btn part-nav-next hidden'>Next Question</button>
					</div>
				</div>
			</div>
		</section>
	</div>
</BaseLayout>

<style>
	/* ══════════════════════════════════════
	   PARTICIPATE — Grid-based participation cards
	   Card accents:
	     Plum   #944E63  (Share Story)
	     Teal   #3B8595  (Feedback)
	     Amber  #C27A3A  (Volunteer)
	     Indigo #4A5899  (Committee)
	   ══════════════════════════════════════ */

	/* Pull canvas flush to header — eat main's mt-8 and grid gap */
	.part-canvas {
		background: #fafaf8;
		padding: 0 1.25rem 2rem;
		margin-top: -2rem;
		overflow-x: hidden; /* ← add this */
	}
	@media (min-width: 768px) {
		.part-canvas {
			padding: 0 2.5rem 2.5rem;
			margin-top: -2rem;
		}
	}
	:global(html.dark) .part-canvas {
		background: #1b1d21;
	}

	/* ── 1. Hero banner — full-bleed, flush to header ── */
	.part-banner {
		position: relative;
		width: 100vw;
		left: 50%;
		transform: translateX(-50%);
		margin-bottom: 3rem;
		overflow: hidden;
		height: 260px;
	}
	@media (min-width: 768px) {
		.part-banner {
			height: 340px;
			margin-bottom: 3.5rem;
		}
	}

	/* Parallax image — will-change for GPU layer */
	.part-banner-img {
		display: block;
		width: 100%;
		height: 100%;
		object-fit: cover;
		object-position: center 35%;
		will-change: transform;
		transform: translateY(0);
		transition: none;
	}

	.part-banner-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(
			to right,
			rgba(30, 20, 25, 0.58) 0%,
			rgba(30, 20, 25, 0.32) 50%,
			rgba(30, 20, 25, 0.08) 100%
		);
		pointer-events: none;
	}

	/* Text container — positioned bottom-left, aligned to grid max-width */
	.part-banner-text {
		position: absolute;
		bottom: 1.75rem;
		left: 1.5rem;
		right: 1.5rem;
		z-index: 2;
	}
	@media (min-width: 768px) {
		.part-banner-text {
			bottom: 2.75rem;
			left: max(2.5rem, calc((100% - 52rem) / 2));
		}
	}

	/* Text entrance animation */
	.part-title,
	.part-sub,
	.part-micro {
		opacity: 0;
		transform: translateY(14px);
		animation: heroTextIn 550ms cubic-bezier(0.22, 0.61, 0.36, 1) forwards;
	}

	.part-title {
		font-size: 2rem;
		font-weight: 750;
		line-height: 1.15;
		color: #ffffff;
		margin: 0;
		letter-spacing: -0.01em;
		text-shadow: 0 2px 8px rgba(0, 0, 0, 0.35);
		animation-delay: 80ms;
	}
	@media (min-width: 768px) {
		.part-title {
			font-size: 2.75rem;
		}
	}

	.part-sub {
		font-size: 1.1rem;
		font-weight: 420;
		color: #f5ede0;
		margin: 0.45rem 0 0;
		line-height: 1.5;
		text-shadow: 0 1px 5px rgba(0, 0, 0, 0.28);
		animation-delay: 200ms;
	}

	.part-micro {
		font-size: 0.8rem;
		color: rgba(255, 255, 255, 0.75);
		margin: 0.3rem 0 0;
		font-style: italic;
		text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
		animation-delay: 320ms;
	}

	@keyframes heroTextIn {
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	@media (prefers-reduced-motion: reduce) {
		.part-title,
		.part-sub,
		.part-micro {
			animation: none;
			opacity: 1;
			transform: none;
		}
	}

	/* ── 2. Card grid ── */
	.part-grid-wrap {
		max-width: 52rem;
		margin: 0 auto 3.5rem;
	}

	.part-grid {
		display: grid;
		grid-template-columns: 1fr;
		gap: 1rem;
	}
	@media (min-width: 640px) {
		.part-grid {
			grid-template-columns: 1fr 1fr;
			gap: 1.25rem;
		}
	}

	/* ── Scroll-triggered entrance ── */
	.pcard {
		position: relative;
		background: #ffffff;
		border-radius: 12px;
		overflow: hidden;
		min-height: 210px;
		display: flex;
		flex-direction: column;
		cursor: pointer;
		border: 1px solid rgba(0, 0, 0, 0.05);
		box-shadow:
			0 1px 3px rgba(0, 0, 0, 0.04),
			0 4px 12px rgba(0, 0, 0, 0.02);
		opacity: 0;
		transform: translateY(18px);
		transition:
			opacity 500ms cubic-bezier(0.22, 0.61, 0.36, 1) var(--stagger, 0ms),
			transform 500ms cubic-bezier(0.22, 0.61, 0.36, 1) var(--stagger, 0ms),
			box-shadow 300ms cubic-bezier(0.22, 0.61, 0.36, 1),
			border-color 300ms ease;
	}
	.pcard.is-visible {
		opacity: 1;
		transform: translateY(0);
	}

	/* Per-card stagger delays + accent tokens */
	.pcard-1 {
		--pc-color: #944e63;
		--pc-rgb: 148, 78, 99;
		--stagger: 0ms;
	}
	.pcard-2 {
		--pc-color: #3b8595;
		--pc-rgb: 59, 133, 149;
		--stagger: 100ms;
	}
	.pcard-3 {
		--pc-color: #c27a3a;
		--pc-rgb: 194, 122, 58;
		--stagger: 200ms;
	}
	.pcard-4 {
		--pc-color: #4a5899;
		--pc-rgb: 74, 88, 153;
		--stagger: 300ms;
	}

	/* Step 1 — Progressive accent bar */
	.pcard-accent {
		height: 3px;
		background: var(--pc-color);
		flex-shrink: 0;
		transition: height 300ms cubic-bezier(0.22, 0.61, 0.36, 1);
	}
	.pcard:hover .pcard-accent,
	.pcard:focus-visible .pcard-accent {
		height: 5px;
	}

	/* Dark mode card base */
	:global(html.dark) .pcard {
		background: #222428;
		border-color: rgba(255, 255, 255, 0.05);
		box-shadow:
			0 1px 3px rgba(0, 0, 0, 0.15),
			0 4px 12px rgba(0, 0, 0, 0.1);
	}

	/* Step 4 — Elevation on intent (only after entrance completes) */
	.pcard.is-visible:hover,
	.pcard.is-visible:focus-visible {
		transform: translateY(-2px);
		border-color: rgba(var(--pc-rgb), 0.12);
		box-shadow:
			0 6px 20px rgba(var(--pc-rgb), 0.08),
			0 2px 6px rgba(0, 0, 0, 0.04);
	}
	:global(html.dark) .pcard.is-visible:hover,
	:global(html.dark) .pcard.is-visible:focus-visible {
		border-color: rgba(var(--pc-rgb), 0.18);
		box-shadow:
			0 6px 24px rgba(0, 0, 0, 0.35),
			0 0 12px rgba(var(--pc-rgb), 0.06);
	}

	/* Step 6 — Focus parity */
	.pcard:focus-visible {
		outline: 2px solid var(--pc-color);
		outline-offset: 2px;
	}

	/* ── Card inner — Step 3: directional cue ── */
	.pcard-inner {
		padding: 1.1rem 1.25rem 1.2rem;
		display: flex;
		flex-direction: column;
		flex: 1;
		transform: translateX(0);
		transition: transform 340ms cubic-bezier(0.22, 0.61, 0.36, 1);
	}
	.pcard:hover .pcard-inner,
	.pcard:focus-visible .pcard-inner {
		transform: translateX(3px);
	}

	/* Header row: icon + title */
	.pcard-header {
		display: flex;
		align-items: center;
		gap: 0.6rem;
		margin-bottom: 0.6rem;
	}

	.pcard-icon {
		width: 20px;
		height: 20px;
		flex-shrink: 0;
		color: var(--pc-color);
	}

	.pcard-title {
		font-size: 1rem;
		font-weight: 620;
		color: #1f1f24;
		margin: 0;
		line-height: 1.3;
		letter-spacing: -0.005em;
	}
	:global(html.dark) .pcard-title {
		color: #e8ecf0;
	}

	/* Description */
	.pcard-desc {
		font-size: 0.85rem;
		color: #5a6370;
		line-height: 1.6;
		margin: 0;
	}
	:global(html.dark) .pcard-desc {
		color: #8a9aa8;
	}

	/* Step 5 — Unified microcopy: meta line (last visible by default) */
	.pcard-meta {
		display: block;
		margin-top: auto;
		padding-top: 0.75rem;
		font-size: 0.72rem;
		font-weight: 550;
		color: var(--pc-color);
		opacity: 0.55;
		letter-spacing: 0.01em;
	}

	/* Step 2 — Reveal line: quiet by default, fades in on intent */
	.pcard-reveal {
		display: block;
		margin-top: 0.35rem;
		font-size: 0.72rem;
		font-weight: 450;
		color: #7a838d;
		font-style: italic;
		opacity: 0;
		max-height: 0;
		overflow: hidden;
		transition:
			opacity 320ms ease 60ms,
			max-height 320ms cubic-bezier(0.22, 0.61, 0.36, 1) 60ms;
	}
	:global(html.dark) .pcard-reveal {
		color: #6b7a88;
	}
	.pcard:hover .pcard-reveal,
	.pcard:focus-visible .pcard-reveal {
		opacity: 0.75;
		max-height: 1.5rem;
	}

	/* ── 3. Support block ── */
	.part-support {
		max-width: 52rem;
		margin: 0 auto 3rem;
		text-align: center;
		padding: 2rem 0 2.5rem;
		border-top: 1px solid rgba(148, 78, 99, 0.08);
	}

	.part-support-line {
		font-size: 0.92rem;
		color: #8a9199;
		margin: 0 0 1rem;
		font-style: italic;
		line-height: 1.6;
	}
	:global(html.dark) .part-support-line {
		color: #6b7a88;
	}

	.part-support-links {
		display: flex;
		justify-content: center;
		flex-wrap: wrap;
		gap: 0.5rem 1.5rem;
	}

	.part-support-link {
		font-size: 0.84rem;
		font-weight: 500;
		color: #944e63;
		text-decoration: none;
		padding: 0.3rem 0;
		border-bottom: 1px solid rgba(148, 78, 99, 0.15);
		transition:
			color 200ms ease,
			border-color 200ms ease;
	}
	.part-support-link:hover {
		color: #3b8595;
		border-color: rgba(59, 133, 149, 0.3);
	}
	:global(html.dark) .part-support-link {
		color: #c9949c;
		border-color: rgba(201, 148, 156, 0.15);
	}
	:global(html.dark) .part-support-link:hover {
		color: #7ab8c5;
		border-color: rgba(122, 184, 197, 0.3);
	}

	/* ── Quiz section ── */
	.part-section {
		max-width: 52rem;
		margin: 0 auto 3.5rem;
	}
	.part-section-title {
		font-size: 1.25rem;
		font-weight: 600;
		color: #944e63;
		margin: 0 0 0.15rem;
		line-height: 1.35;
		padding-bottom: 0.6rem;
	}
	:global(html.dark) .part-section-title {
		color: #c9949c;
	}

	.part-body-lead {
		font-size: 1.05rem;
		line-height: 1.9;
		color: #1f1f24;
		margin: 0 0 1rem;
	}
	:global(html.dark) .part-body-lead {
		color: #e8ecf0;
	}

	.part-quiz-section {
		padding-top: 2.5rem;
		border-top: 1px solid rgba(148, 78, 99, 0.1);
	}
	:global(html.dark) .part-quiz-section {
		border-top-color: rgba(168, 112, 128, 0.08);
	}

	.part-quiz-sub {
		font-size: 0.9rem;
		line-height: 1.6;
		color: #6b7280;
		margin: 0 0 1.5rem;
	}
	:global(html.dark) .part-quiz-sub {
		color: #8a9aa8;
	}

	.part-quiz-container {
		background: #ffffff;
		border: 1px solid rgba(180, 123, 132, 0.08);
		border-radius: 14px;
		overflow: hidden;
	}
	:global(html.dark) .part-quiz-container {
		background: #252729;
		border-color: rgba(180, 123, 132, 0.06);
	}

	.part-quiz-inner {
		padding: 1.5rem;
	}
	@media (min-width: 768px) {
		.part-quiz-inner {
			padding: 2rem;
		}
	}

	.part-quiz-progress-wrap {
		margin-bottom: 1.5rem;
	}
	.part-quiz-progress-meta {
		display: flex;
		justify-content: space-between;
		font-size: 0.82rem;
		font-weight: 600;
		color: #8a9199;
		margin-bottom: 0.5rem;
	}
	:global(html.dark) .part-quiz-progress-meta {
		color: #6b7a88;
	}

	.part-quiz-track {
		width: 100%;
		height: 5px;
		background: #f0f0ee;
		border-radius: 3px;
		overflow: hidden;
	}
	:global(html.dark) .part-quiz-track {
		background: #2e3033;
	}

	.part-quiz-bar {
		height: 100%;
		border-radius: 3px;
		background: linear-gradient(90deg, #944e63, #b47b84);
		transition: width 400ms ease;
	}

	.part-quiz-heading {
		font-size: 1.1rem;
		font-weight: 650;
		color: #944e63;
		margin: 0 0 0.75rem;
	}
	:global(html.dark) .part-quiz-heading {
		color: #e8ecf0;
	}

	.part-quiz-desc {
		font-size: 0.95rem;
		line-height: 1.8;
		color: #556370;
		margin: 0 0 1.25rem;
	}
	:global(html.dark) .part-quiz-desc {
		color: #8a9aa8;
	}

	.part-quiz-options {
		display: flex;
		flex-direction: column;
		gap: 0.6rem;
	}

	.part-option {
		display: flex;
		align-items: flex-start;
		gap: 0.75rem;
		width: 100%;
		text-align: left;
		padding: 0.9rem 1rem;
		border: 1px solid #ebebea;
		border-radius: 10px;
		background: #ffffff;
		font-size: 0.9rem;
		line-height: 1.55;
		color: #1f1f24;
		cursor: pointer;
		transition:
			border-color 200ms ease,
			box-shadow 200ms ease;
	}
	:global(html.dark) .part-option {
		background: #1b1d21;
		border-color: #2e3033;
		color: #e8ecf0;
	}
	.part-option:hover:not(:disabled) {
		border-color: #b47b84;
		box-shadow: 0 2px 8px rgba(148, 78, 99, 0.05);
	}
	.part-option:disabled {
		cursor: not-allowed;
		opacity: 0.85;
	}

	.part-option-letter {
		flex-shrink: 0;
		width: 26px;
		height: 26px;
		border-radius: 50%;
		background: rgba(148, 78, 99, 0.06);
		color: #944e63;
		font-weight: 700;
		font-size: 0.78rem;
		display: flex;
		align-items: center;
		justify-content: center;
	}
	:global(html.dark) .part-option-letter {
		background: rgba(168, 112, 128, 0.1);
		color: #c9949c;
	}

	.part-feedback {
		margin-top: 1rem;
		padding: 1rem;
		border-radius: 10px;
		font-size: 0.9rem;
		line-height: 1.65;
	}

	.part-results-inner {
		text-align: center;
		padding: 2rem 0;
	}
	.part-results-message {
		background: rgba(148, 78, 99, 0.05);
		border-radius: 10px;
		padding: 1.25rem;
		margin: 1.25rem 0;
		font-size: 0.95rem;
		line-height: 1.7;
		color: #556370;
	}
	:global(html.dark) .part-results-message {
		background: rgba(168, 112, 128, 0.06);
		color: #8a9aa8;
	}

	.part-restart {
		display: inline-flex;
		align-items: center;
		padding: 0.7rem 1.6rem;
		border-radius: 9px;
		font-size: 0.875rem;
		font-weight: 600;
		background: #944e63;
		color: #ffffff;
		border: none;
		cursor: pointer;
		box-shadow: 0 2px 10px rgba(148, 78, 99, 0.15);
		transition: box-shadow 200ms ease;
	}
	.part-restart:hover {
		box-shadow: 0 4px 18px rgba(148, 78, 99, 0.25);
	}
	:global(html.dark) .part-restart {
		background: #a87080;
		color: #1b1d21;
	}

	.part-nav-buttons {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-top: 1.25rem;
	}
	.part-nav-prev,
	.part-nav-next {
		padding: 0.55rem 1.25rem;
		border-radius: 8px;
		font-size: 0.85rem;
		font-weight: 600;
		cursor: pointer;
		border: none;
		transition:
			background 200ms ease,
			box-shadow 200ms ease;
	}
	.part-nav-prev {
		background: #f0f0ee;
		color: #556370;
	}
	:global(html.dark) .part-nav-prev {
		background: #2e3033;
		color: #8a9aa8;
	}
	.part-nav-prev:hover {
		background: #e5e5e3;
	}
	:global(html.dark) .part-nav-prev:hover {
		background: #3a3d40;
	}

	.part-nav-next {
		background: #944e63;
		color: #ffffff;
		box-shadow: 0 2px 8px rgba(148, 78, 99, 0.12);
	}
	:global(html.dark) .part-nav-next {
		background: #a87080;
	}
	.part-nav-next:hover {
		box-shadow: 0 4px 14px rgba(148, 78, 99, 0.2);
	}

	/* ── Quiz animations ── */
	.question {
		display: none;
		animation: fadeUp 0.3s ease;
	}
	.question.active {
		display: block;
	}
	.results {
		display: none;
		animation: fadeUp 0.3s ease;
	}
	.results:not(.hidden) {
		display: block;
	}

	@keyframes fadeUp {
		from {
			opacity: 0;
			transform: translateY(6px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	.option-btn.correct {
		border-color: #10b981 !important;
		background: rgba(16, 185, 129, 0.05) !important;
	}
	.option-btn.incorrect {
		border-color: #ef4444 !important;
		background: rgba(239, 68, 68, 0.03) !important;
	}

	/* ── Reduced motion ── */
	@media (prefers-reduced-motion: reduce) {
		.pcard {
			opacity: 1 !important;
			transform: none !important;
			transition-duration: 0ms !important;
		}
		.pcard-accent,
		.pcard-inner,
		.pcard-reveal,
		.part-option,
		.part-restart,
		.part-nav-prev,
		.part-nav-next {
			transition-duration: 0ms !important;
		}
	}
</style>

<script>
	;(function initParallax() {
		function setup() {
			const banner = document.querySelector('.part-banner') as HTMLElement | null
			const img = document.querySelector('.part-banner-img') as HTMLElement | null
			if (!banner || !img) return

			const bannerEl = banner
			const imgEl = img
			let ticking = false
			function onScroll() {
				if (ticking) return
				ticking = true
				requestAnimationFrame(() => {
					const rect = bannerEl.getBoundingClientRect()
					const bannerH = bannerEl.offsetHeight
					if (rect.bottom > 0 && rect.top < window.innerHeight) {
						const progress = (window.innerHeight - rect.top) / (window.innerHeight + bannerH)
						const offset = (progress - 0.5) * bannerH * 0.25
						imgEl.style.transform = `translateY(${offset}px)`
					}
					ticking = false
				})
			}

			window.addEventListener('scroll', onScroll, { passive: true })
			onScroll()
		}

		if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', setup)
		} else {
			setup()
		}
		document.addEventListener('astro:page-load', setup)
	})()
	;(function initScrollReveal() {
		function setup() {
			const cards = document.querySelectorAll('.pcard')
			if (!cards.length) return

			if (!('IntersectionObserver' in window)) {
				cards.forEach((c) => c.classList.add('is-visible'))
				return
			}

			const observer = new IntersectionObserver(
				(entries) => {
					entries.forEach((entry) => {
						if (entry.isIntersecting) {
							entry.target.classList.add('is-visible')
							observer.unobserve(entry.target)
						}
					})
				},
				{ threshold: 0.15, rootMargin: '0px 0px -40px 0px' }
			)

			cards.forEach((card) => observer.observe(card))
		}

		if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', setup)
		} else {
			setup()
		}
		document.addEventListener('astro:page-load', setup)
	})()

	document.addEventListener('DOMContentLoaded', () => {
		let currentQuestion = 1
		let score = 0
		const totalQuestions = 3
		const correctAnswers: Record<number, string> = { 1: 'd', 2: 'b', 3: 'c' }
		const feedbackText: Record<number, { correct: string; incorrect: string }> = {
			1: {
				correct:
					'Providing multiple ways to contribute respects different communication styles and cultural norms, creating an inclusive environment where everyone can participate comfortably.',
				incorrect:
					'Consider that students from different backgrounds may have varying comfort levels with direct verbal participation. Offering multiple modes of contribution creates a more inclusive environment.'
			},
			2: {
				correct:
					'A rotating monthly celebration ensures diverse representation and gives everyone a chance to share their culture. This approach is both practical and inclusive.',
				incorrect:
					'The best approach involves students in the decision-making process. A rotating celebration schedule ensures all cultures are valued equally.'
			},
			3: {
				correct:
					'Gently redirecting protects the student while addressing the issue, and following up privately shows support without putting them on the spot.',
				incorrect:
					"The most effective approach balances immediate intervention with sensitivity. Gently redirecting the conversation and checking in privately respects the student's agency while addressing the harm."
			}
		}

		const questions = document.querySelectorAll('.question')
		const prevBtn = document.querySelector('.prev-btn') as HTMLButtonElement
		const nextBtn = document.querySelector('.next-btn') as HTMLButtonElement
		const restartBtn = document.querySelector('.restart-btn') as HTMLButtonElement
		const resultsDiv = document.querySelector('.results') as HTMLElement
		const quizProgress = document.querySelector('.quiz-progress') as HTMLElement
		const currentQuestionSpan = document.querySelector('.current-question') as HTMLElement
		const progressPercentage = document.querySelector('.progress-percentage') as HTMLElement

		document.querySelectorAll('.option-btn').forEach((btn) => {
			btn.addEventListener('click', function (this: HTMLButtonElement) {
				const question = this.closest('.question') as HTMLElement
				const questionNum = parseInt(question.dataset.question || '1')
				const selectedAnswer = this.dataset.answer
				const feedbackDiv = question.querySelector('.feedback') as HTMLElement
				question
					.querySelectorAll('.option-btn')
					.forEach((b) => b.classList.remove('selected', 'correct', 'incorrect'))
				this.classList.add('selected')
				const isCorrect = selectedAnswer === correctAnswers[questionNum]
				if (isCorrect) {
					this.classList.add('correct')
					score++
					feedbackDiv.innerHTML = `<div style="color:#065f46;">${feedbackText[questionNum].correct}</div>`
				} else {
					this.classList.add('incorrect')
					feedbackDiv.innerHTML = `<div style="color:#944E63;">${feedbackText[questionNum].incorrect}</div>`
				}
				feedbackDiv.classList.remove('hidden')
				question
					.querySelectorAll('.option-btn')
					.forEach((b) => ((b as HTMLButtonElement).disabled = true))
				if (currentQuestion < totalQuestions) nextBtn.classList.remove('hidden')
				else setTimeout(showResults, 800)
				if (currentQuestion > 1) prevBtn.classList.remove('hidden')
			})
		})

		nextBtn?.addEventListener('click', () => {
			if (currentQuestion < totalQuestions) {
				questions[currentQuestion - 1].classList.remove('active')
				questions[currentQuestion - 1].classList.add('hidden')
				currentQuestion++
				questions[currentQuestion - 1].classList.remove('hidden')
				questions[currentQuestion - 1].classList.add('active')
				nextBtn.classList.add('hidden')
				updateProgress()
			}
		})
		prevBtn?.addEventListener('click', () => {
			if (currentQuestion > 1) {
				questions[currentQuestion - 1].classList.remove('active')
				questions[currentQuestion - 1].classList.add('hidden')
				currentQuestion--
				questions[currentQuestion - 1].classList.remove('hidden')
				questions[currentQuestion - 1].classList.add('active')
				nextBtn.classList.remove('hidden')
				updateProgress()
			}
		})
		restartBtn?.addEventListener('click', () => {
			currentQuestion = 1
			score = 0
			questions.forEach((q, i) => {
				q.classList.remove('active', 'hidden')
				if (i === 0) q.classList.add('active')
				else q.classList.add('hidden')
				q.querySelectorAll('.option-btn').forEach((b) => {
					;(b as HTMLButtonElement).disabled = false
					b.classList.remove('selected', 'correct', 'incorrect')
				})
				const fb = q.querySelector('.feedback')
				if (fb) fb.classList.add('hidden')
			})
			resultsDiv.classList.add('hidden')
			prevBtn.classList.add('hidden')
			nextBtn.classList.add('hidden')
			updateProgress()
		})

		function updateProgress() {
			const progress = (currentQuestion / totalQuestions) * 100
			if (quizProgress) quizProgress.style.width = progress + '%'
			if (currentQuestionSpan) currentQuestionSpan.textContent = String(currentQuestion)
			if (progressPercentage) progressPercentage.textContent = Math.round(progress) + '%'
		}
		function showResults() {
			questions.forEach((q) => q.classList.add('hidden'))
			prevBtn.classList.add('hidden')
			nextBtn.classList.add('hidden')
			resultsDiv.classList.remove('hidden')
			const scoreEl = document.querySelector('.score')
			if (scoreEl) scoreEl.textContent = String(score)
			const messageP = document.querySelector('.results-message p')
			if (messageP) {
				if (score === 3)
					messageP.textContent =
						'Outstanding! You have a strong understanding of EDI principles. Consider joining our committees to share your insights.'
				else if (score === 2)
					messageP.textContent =
						"Great job! You're on the right track. Keep learning and engaging with EDI resources."
				else
					messageP.textContent =
						'Thank you for participating! Explore our workshops and resources to learn more about creating inclusive environments.'
			}
		}
	})
</script>
