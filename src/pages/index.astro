---
/**
 * Home Page (EDI McGill)
 *
 * Redesigned home page with:
 * - Hero section with clear orientation
 * - Updates preview (4-6 mixed content tiles)
 * - Audience routing
 * - Featured interactive element
 * - Impact snapshot
 * - Featured stories
 * - Support visibility
 */
import BaseLayout from '@/layouts/BaseLayout'
import { getCollection } from 'astro:content'
import { Image } from 'astro:assets'
import bannerImage from '../assets/images/Diversity1.jpg'
import FormattedDate from '@/components/FormattedDate'
import Tag from '@/components/Tag'

// Fetch recent content from all collections (up to 6 items)
let recentUpdates: Array<{
	type: string
	data: any
	slug: string
	collection: string
}> = []

try {
	const [events, stories, resources, reports, blogPosts] = await Promise.all([
		getCollection('events', ({ data }) => !data.draft).catch(() => []),
		getCollection('stories', ({ data }) => !data.draft).catch(() => []),
		getCollection('resources', ({ data }) => !data.draft).catch(() => []),
		getCollection('reports', ({ data }) => !data.draft).catch(() => []),
		getCollection('blog', ({ data }) => !data.draft).catch(() => [])
	])

	// Combine and sort all content by date
	const allContent = [
		...events.map((e) => ({ ...e, collection: 'events', type: 'Event' })),
		...stories.map((s) => ({ ...s, collection: 'stories', type: 'Story' })),
		...resources.map((r) => ({ ...r, collection: 'resources', type: 'Resource' })),
		...reports.map((r) => ({ ...r, collection: 'reports', type: 'Report' })),
		...blogPosts.map((b) => ({ ...b, collection: 'blog', type: 'Blog' }))
	]

	recentUpdates = allContent
		.sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime())
		.slice(0, 6)
} catch (error) {
	console.log('Error fetching content:', error)
}

const typeColors: Record<string, string> = {
	Event: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
	Story: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
	Resource: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
	Report: 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200',
	Blog: 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200'
}

const getContentHref = (item: any) => {
	if (item.collection === 'blog') return `/post/${item.slug}`
	return `/${item.collection}/${item.slug}`
}
---

<BaseLayout
	title='Home'
	description='EDI McGill - Promoting Equity, Diversity, and Inclusion at McGill University'
>
	<!-- 1. HERO SECTION - Clear Orientation -->
	<section class='hero-section -mt-4 mb-16'>
		<div class='relative w-full h-[450px] md:h-[550px] rounded-2xl overflow-hidden shadow-2xl mb-6'>
			<Image
				src={bannerImage}
				alt='EDI McGill - Diversity and Inclusion'
				class='w-full h-full object-cover opacity-15'
				width={1200}
				height={550}
			/>
			<div
				class='absolute inset-0 bg-gradient-to-r from-blue-900/85 via-purple-900/75 to-transparent flex items-center'
			>
				<div class='max-w-4xl px-8 md:px-16 text-white'>
					<div
						class='mb-4 inline-block bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-sm font-semibold border border-white/30'
					>
						McGill University
					</div>
					<h1 class='text-4xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight'>EDI McGill</h1>
					<p class='text-xl md:text-3xl mb-4 font-light'>
						Promoting Equity, Diversity, and Inclusion
					</p>
					<p class='text-lg md:text-xl mb-8 text-blue-100 max-w-2xl'>
						A McGill-affiliated initiative fostering an inclusive campus community where everyone
						belongs
					</p>
					<div class='flex flex-wrap gap-4'>
						<a
							href='/about'
							class='bg-white text-blue-900 px-8 py-4 rounded-xl font-bold hover:bg-blue-50 transition-all hover:scale-105 shadow-lg hover:shadow-xl'
						>
							Learn More â†’
						</a>
						<a
							href='/participate'
							class='bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl font-bold hover:from-blue-700 hover:to-purple-700 transition-all hover:scale-105 shadow-lg hover:shadow-xl'
						>
							Get Involved
						</a>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- 2. WHAT'S HAPPENING NOW - Updates Preview -->
	<section class='updates-preview mb-20'>
		<div class='flex items-center justify-between mb-8'>
			<div>
				<h2 class='text-4xl font-bold dark:text-white mb-2'>What's Happening Now</h2>
				<p class='text-gray-600 dark:text-gray-400'>
					Stay up to date with our latest initiatives and stories
				</p>
			</div>
		</div>

		{
			recentUpdates.length > 0 ? (
				<div class='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8'>
					{recentUpdates.map((item) => (
						<a
							href={getContentHref(item)}
							class='group block bg-white dark:bg-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-xl p-6 hover:border-blue-500 dark:hover:border-blue-400 transition-all hover:shadow-2xl hover:-translate-y-1'
						>
							<div class='flex items-center gap-3 mb-4'>
								<span class={`px-3 py-1.5 rounded-lg text-xs font-bold ${typeColors[item.type]}`}>
									{item.type}
								</span>
								<FormattedDate date={item.data.pubDate} />
							</div>
							<h3 class='text-xl font-bold mb-3 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors'>
								{item.data.title}
							</h3>
							<p class='text-gray-600 dark:text-gray-300 text-sm line-clamp-3 leading-relaxed'>
								{item.data.description}
							</p>
							<div class='mt-4 text-blue-600 dark:text-blue-400 font-semibold text-sm group-hover:translate-x-2 transition-transform inline-block'>
								Read more â†’
							</div>
						</a>
					))}
				</div>
			) : (
				<div class='bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950 dark:to-purple-950 rounded-xl p-12 text-center mb-8'>
					<div class='text-6xl mb-4'>ğŸš€</div>
					<p class='text-xl text-gray-700 dark:text-gray-300 font-medium'>Updates coming soon!</p>
				</div>
			)
		}

		<div class='text-center'>
			<a
				href='/updates'
				class='inline-block bg-gradient-to-r from-blue-600 to-purple-600 text-white px-10 py-4 rounded-xl font-bold hover:from-blue-700 hover:to-purple-700 transition-all hover:scale-105 shadow-lg hover:shadow-xl'
			>
				View All Updates â†’
			</a>
		</div>
	</section>

	<!-- 3. WHO IS THIS FOR? - Audience Routing -->
	<section class='audience-routing mb-20'>
		<div class='text-center mb-12'>
			<h2 class='text-4xl font-bold mb-3 dark:text-white'>Who Is This For?</h2>
			<p class='text-xl text-gray-600 dark:text-gray-400'>Find resources tailored to your role</p>
		</div>

		<div class='grid grid-cols-1 md:grid-cols-3 gap-8'>
			<!-- Students -->
			<div
				class='group relative bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 border-2 border-blue-200 dark:border-blue-800 rounded-2xl p-8 hover:border-blue-500 dark:hover:border-blue-400 transition-all hover:shadow-2xl hover:-translate-y-2'
			>
				<div class='text-5xl mb-4'>ğŸ“</div>
				<h3 class='text-3xl font-bold mb-4 dark:text-white'>Students</h3>
				<p class='text-gray-700 dark:text-gray-300 mb-6 text-lg'>
					Access resources, share your story, and join our community
				</p>
				<ul class='space-y-3'>
					<li>
						<a
							href='/programs'
							class='flex items-center text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> Upcoming
							workshops
						</a>
					</li>
					<li>
						<a
							href='/resources'
							class='flex items-center text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> Student
							support resources
						</a>
					</li>
					<li>
						<a
							href='/participate'
							class='flex items-center text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> Share your
							experience
						</a>
					</li>
				</ul>
			</div>

			<!-- Staff -->
			<div
				class='group relative bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900 border-2 border-purple-200 dark:border-purple-800 rounded-2xl p-8 hover:border-purple-500 dark:hover:border-purple-400 transition-all hover:shadow-2xl hover:-translate-y-2'
			>
				<div class='text-5xl mb-4'>ğŸ‘¥</div>
				<h3 class='text-3xl font-bold mb-4 dark:text-white'>Staff</h3>
				<p class='text-gray-700 dark:text-gray-300 mb-6 text-lg'>
					Training, resources, and tools to support inclusive practices
				</p>
				<ul class='space-y-3'>
					<li>
						<a
							href='/programs'
							class='flex items-center text-purple-700 dark:text-purple-300 hover:text-purple-900 dark:hover:text-purple-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> Professional
							development
						</a>
					</li>
					<li>
						<a
							href='/resources'
							class='flex items-center text-purple-700 dark:text-purple-300 hover:text-purple-900 dark:hover:text-purple-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> EDI toolkits
							& guides
						</a>
					</li>
					<li>
						<a
							href='/participate'
							class='flex items-center text-purple-700 dark:text-purple-300 hover:text-purple-900 dark:hover:text-purple-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> Join a
							committee
						</a>
					</li>
				</ul>
			</div>

			<!-- Faculty / Leadership -->
			<div
				class='group relative bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900 border-2 border-green-200 dark:border-green-800 rounded-2xl p-8 hover:border-green-500 dark:hover:border-green-400 transition-all hover:shadow-2xl hover:-translate-y-2'
			>
				<div class='text-5xl mb-4'>ğŸ¯</div>
				<h3 class='text-3xl font-bold mb-4 dark:text-white'>Faculty & Leadership</h3>
				<p class='text-gray-700 dark:text-gray-300 mb-6 text-lg'>
					Research, reports, and strategic EDI initiatives
				</p>
				<ul class='space-y-3'>
					<li>
						<a
							href='/reports'
							class='flex items-center text-green-700 dark:text-green-300 hover:text-green-900 dark:hover:text-green-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> EDI reports
							& data
						</a>
					</li>
					<li>
						<a
							href='/resources'
							class='flex items-center text-green-700 dark:text-green-300 hover:text-green-900 dark:hover:text-green-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> Policy
							resources
						</a>
					</li>
					<li>
						<a
							href='/about'
							class='flex items-center text-green-700 dark:text-green-300 hover:text-green-900 dark:hover:text-green-100 font-semibold text-lg group/link'
						>
							<span class='mr-2 group-hover/link:translate-x-1 transition-transform'>â†’</span> Our approach
						</a>
					</li>
				</ul>
			</div>
		</div>
	</section>

	<!-- 4. FEATURED INTERACTIVE ELEMENT -->
	<section class='interactive-element mb-20'>
		<div
			class='relative bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 rounded-3xl p-12 shadow-2xl overflow-hidden'
		>
			<div
				class='absolute inset-0 bg-[url("data:image/svg+xml,%3Csvg width=\'
				60\'
				height="\'60\'"
				viewBox="\'0"
				0
				60
				60\'
				xmlns="\'http://www.w3.org/2000/svg\'%3E%3Cg"
				fill="\'none\'"
				fill-rule="\'evenodd\'%3E%3Cg"
				fill="\'%23ffffff\'"
				fill-opacity="\'0.05\'%3E%3Cpath"
				d="\'M36"
				34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6
				34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6
				4V0H4v4H0v2h4v4h2V6h4V4H6z\'
				%3E%3C
				g%3E%3C
				g%3E%3C
				svg%3E")]'
			>
			</div>
			<div class='relative max-w-4xl mx-auto text-center text-white'>
				<div class='text-6xl mb-6'>ğŸ”</div>
				<h2 class='text-4xl md:text-5xl font-bold mb-6'>Quick Check: Find Your Resources</h2>
				<p class='text-xl md:text-2xl mb-3 font-light'>
					Not sure where to start? Use our resource finder to discover what's relevant to you.
				</p>
				<div
					class='inline-block bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-sm font-semibold mb-8 border border-white/30'
				>
					â±ï¸ Takes about 2 minutes
				</div>
				<div>
					<a
						href='/resources'
						class='inline-block bg-white text-purple-900 px-10 py-4 rounded-xl font-bold hover:bg-gray-100 transition-all hover:scale-105 shadow-xl text-lg'
					>
						Find Resources â†’
					</a>
				</div>
			</div>
		</div>
	</section>

	<!-- 5. CREDIBILITY / IMPACT SNAPSHOT -->
	<section class='impact-snapshot mb-20'>
		<div class='text-center mb-12'>
			<h2 class='text-4xl font-bold mb-3 dark:text-white'>Our Impact</h2>
			<p class='text-xl text-gray-600 dark:text-gray-400'>
				Making a real difference in our community
			</p>
		</div>

		<div class='grid grid-cols-2 md:grid-cols-4 gap-6'>
			<div
				class='text-center p-8 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 border-2 border-blue-200 dark:border-blue-800 rounded-2xl hover:scale-105 transition-transform'
			>
				<div class='text-5xl md:text-6xl font-bold text-blue-600 dark:text-blue-400 mb-3'>50+</div>
				<div class='text-gray-700 dark:text-gray-300 font-semibold text-lg'>
					Workshops Delivered
				</div>
			</div>
			<div
				class='text-center p-8 bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900 border-2 border-purple-200 dark:border-purple-800 rounded-2xl hover:scale-105 transition-transform'
			>
				<div class='text-5xl md:text-6xl font-bold text-purple-600 dark:text-purple-400 mb-3'>
					1,200+
				</div>
				<div class='text-gray-700 dark:text-gray-300 font-semibold text-lg'>
					Participants Reached
				</div>
			</div>
			<div
				class='text-center p-8 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900 border-2 border-green-200 dark:border-green-800 rounded-2xl hover:scale-105 transition-transform'
			>
				<div class='text-5xl md:text-6xl font-bold text-green-600 dark:text-green-400 mb-3'>
					30+
				</div>
				<div class='text-gray-700 dark:text-gray-300 font-semibold text-lg'>Resources Created</div>
			</div>
			<div
				class='text-center p-8 bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900 border-2 border-orange-200 dark:border-orange-800 rounded-2xl hover:scale-105 transition-transform'
			>
				<div class='text-5xl md:text-6xl font-bold text-orange-600 dark:text-orange-400 mb-3'>
					5
				</div>
				<div class='text-gray-700 dark:text-gray-300 font-semibold text-lg'>Annual Reports</div>
			</div>
		</div>
	</section>

	<!-- 6. HUMAN ELEMENT - Featured Stories -->
	<section class='featured-stories mb-20'>
		<div class='text-center mb-12'>
			<h2 class='text-4xl font-bold mb-3 dark:text-white'>Community Voices</h2>
			<p class='text-xl text-gray-600 dark:text-gray-400'>Real stories from real people</p>
		</div>

		<div class='grid grid-cols-1 md:grid-cols-3 gap-8'>
			<a
				href='/stories'
				class='group block bg-white dark:bg-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-2xl p-8 hover:border-blue-500 dark:hover:border-blue-400 transition-all hover:shadow-2xl hover:-translate-y-2'
			>
				<div class='text-6xl mb-5'>ğŸ’¬</div>
				<h3
					class='text-2xl font-bold mb-3 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors'
				>
					Student Experiences
				</h3>
				<p class='text-gray-600 dark:text-gray-300 mb-5 text-lg leading-relaxed'>
					Read personal stories from McGill students
				</p>
				<span
					class='text-blue-600 dark:text-blue-400 font-bold text-lg inline-flex items-center group-hover:translate-x-2 transition-transform'
				>
					Read Stories <span class='ml-2'>â†’</span>
				</span>
			</a>

			<a
				href='/stories'
				class='group block bg-white dark:bg-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-2xl p-8 hover:border-purple-500 dark:hover:border-purple-400 transition-all hover:shadow-2xl hover:-translate-y-2'
			>
				<div class='text-6xl mb-5'>ğŸ¯</div>
				<h3
					class='text-2xl font-bold mb-3 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors'
				>
					Success Stories
				</h3>
				<p class='text-gray-600 dark:text-gray-300 mb-5 text-lg leading-relaxed'>
					How EDI initiatives are making a difference
				</p>
				<span
					class='text-purple-600 dark:text-purple-400 font-bold text-lg inline-flex items-center group-hover:translate-x-2 transition-transform'
				>
					Learn More <span class='ml-2'>â†’</span>
				</span>
			</a>

			<a
				href='/stories'
				class='group block bg-white dark:bg-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-2xl p-8 hover:border-green-500 dark:hover:border-green-400 transition-all hover:shadow-2xl hover:-translate-y-2'
			>
				<div class='text-6xl mb-5'>ğŸŒŸ</div>
				<h3
					class='text-2xl font-bold mb-3 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors'
				>
					Community Highlights
				</h3>
				<p class='text-gray-600 dark:text-gray-300 mb-5 text-lg leading-relaxed'>
					Celebrating our diverse McGill community
				</p>
				<span
					class='text-green-600 dark:text-green-400 font-bold text-lg inline-flex items-center group-hover:translate-x-2 transition-transform'
				>
					Explore <span class='ml-2'>â†’</span>
				</span>
			</a>
		</div>
	</section>

	<!-- 7. SUPPORT VISIBILITY -->
	<section class='support-strip mb-12'>
		<div
			class='bg-gradient-to-r from-blue-100 to-cyan-100 dark:from-blue-900 dark:to-cyan-900 border-2 border-blue-300 dark:border-blue-700 rounded-2xl p-8 md:p-10 shadow-lg'
		>
			<div class='flex flex-col md:flex-row items-center justify-between gap-6'>
				<div class='flex items-start gap-4 flex-1'>
					<div class='text-5xl'>ğŸ¤</div>
					<div>
						<h3 class='text-2xl md:text-3xl font-bold mb-2 dark:text-white'>
							Need Support or Accommodations?
						</h3>
						<p class='text-gray-700 dark:text-gray-300 text-lg'>
							We're here to help. Access resources and support services.
						</p>
					</div>
				</div>
				<div class='flex flex-wrap gap-4 justify-center md:justify-end'>
					<a
						href='/resources'
						class='bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition-all hover:scale-105 shadow-lg whitespace-nowrap'
					>
						Get Support
					</a>
					<a
						href='/resources'
						class='bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 border-2 border-blue-600 dark:border-blue-400 px-8 py-3 rounded-xl font-bold hover:bg-blue-50 dark:hover:bg-gray-700 transition-all hover:scale-105 whitespace-nowrap'
					>
						View Resources
					</a>
				</div>
			</div>
		</div>
	</section>
</BaseLayout>

<style>
	.line-clamp-2 {
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.line-clamp-3 {
		display: -webkit-box;
		-webkit-line-clamp: 3;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}
</style>
