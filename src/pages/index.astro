---
/**
 * Home Page (EDI McGill)
 *
 * Redesigned home page with:
 * - Hero section with clear orientation
 * - Updates preview (4-6 mixed content tiles)
 * - Audience routing
 * - Featured interactive element
 * - Impact snapshot
 * - Featured stories
 * - Support visibility
 * - AOS scroll animations for enhanced UX
 */
import BaseLayout from '@/layouts/BaseLayout'
import { getCollection } from 'astro:content'
import { Image } from 'astro:assets'
import bannerImage from '../assets/images/Diversity1.jpg'
import FormattedDate from '@/components/FormattedDate'
import Tag from '@/components/Tag'
import 'aos/dist/aos.css'
import { GraduationCap, Users, Target, Rocket, HandHeart } from 'lucide-astro'

// Fetch recent content from all collections (up to 6 items)
let recentUpdates: Array<{
	type: string
	data: any
	slug: string
	collection: string
}> = []

try {
	const [events, stories, resources, reports, blogPosts] = await Promise.all([
		getCollection('events', ({ data }) => !data.draft).catch(() => []),
		getCollection('stories', ({ data }) => !data.draft).catch(() => []),
		getCollection('resources', ({ data }) => !data.draft).catch(() => []),
		getCollection('reports', ({ data }) => !data.draft).catch(() => []),
		getCollection('blog', ({ data }) => !data.draft).catch(() => [])
	])

	// Map blog post categories to appropriate types
	const getCategoryType = (category: string) => {
		if (category === 'Events & Workshops') return 'Programs'
		if (category === 'Home Page') return 'About'
		if (category === 'Resources & Support') return 'Resources'
		if (category === 'Blogs & Stories') return 'Stories'
		return 'Updates'
	}

	// Combine and sort all content by date (handle undefined/null)
	const allContent = [
		...(events || []).map((e) => ({ ...e, collection: 'events', type: 'Programs' })),
		...(stories || []).map((s) => ({ ...s, collection: 'stories', type: 'Stories' })),
		...(resources || []).map((r) => ({ ...r, collection: 'resources', type: 'Resources' })),
		...(reports || []).map((r) => ({ ...r, collection: 'reports', type: 'Reports' })),
		...(blogPosts || []).map((b) => ({
			...b,
			collection: 'blog',
			type: getCategoryType(b.data.category)
		}))
	]

	recentUpdates = allContent
		.sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime())
		.slice(0, 6)
} catch (error) {
	console.log('Error fetching content:', error)
	recentUpdates = []
}

// Color coding with emotional purpose - warm, muted, human tones
const typeColors: Record<string, string> = {
	Programs: 'bg-[#DBEAFE]/80 text-[#1E40AF] dark:bg-[#1E3A8A]/60 dark:text-[#93C5FD]', // Sky blue - calm, trustworthy
	Stories: 'bg-[#FED7AA]/80 text-[#C2410C] dark:bg-[#7C2D12]/60 dark:text-[#FED7AA]', // Warm peach - personal, welcoming
	Resources: 'bg-[#D1FAE5]/80 text-[#065F46] dark:bg-[#064E3B]/60 dark:text-[#A7F3D0]', // Sage green - calming, supportive
	Reports: 'bg-[#E2E8F0]/80 text-[#475569] dark:bg-[#334155]/60 dark:text-[#CBD5E1]', // Warm gray - neutral, formal
	About: 'bg-[#CCFBF1]/80 text-[#115E59] dark:bg-[#134E4A]/60 dark:text-[#99F6E4]', // Soft teal - community
	Updates: 'bg-[#F3E8FF]/80 text-[#7C3AED] dark:bg-[#5B21B6]/60 dark:text-[#DDD6FE]' // Soft lavender
}

const cardGradients: Record<string, string> = {
	Programs:
		'from-[#F0F9FF]/50 via-white/80 to-[#E0F2FE]/40 dark:from-[#1E3A8A]/30 dark:via-gray-900/20 dark:to-[#1E40AF]/20',
	Stories:
		'from-[#FFF7ED]/50 via-white/80 to-[#FFEDD5]/40 dark:from-[#7C2D12]/30 dark:via-gray-900/20 dark:to-[#9A3412]/20',
	Resources:
		'from-[#F0FDF4]/50 via-white/80 to-[#DCFCE7]/40 dark:from-[#064E3B]/30 dark:via-gray-900/20 dark:to-[#065F46]/20',
	Reports:
		'from-[#F8FAFC]/50 via-white/80 to-[#F1F5F9]/40 dark:from-[#334155]/30 dark:via-gray-900/20 dark:to-[#475569]/20',
	About:
		'from-[#F0FDFA]/50 via-white/80 to-[#CCFBF1]/40 dark:from-[#134E4A]/30 dark:via-gray-900/20 dark:to-[#115E59]/20',
	Updates:
		'from-[#FAF5FF]/50 via-white/80 to-[#F3E8FF]/40 dark:from-[#5B21B6]/30 dark:via-gray-900/20 dark:to-[#6D28D9]/20'
}

const hoverColors: Record<string, string> = {
	Programs: 'hover:border-[#93C5FD]/60 hover:shadow-lg',
	Stories: 'hover:border-[#FED7AA]/60 hover:shadow-lg',
	Resources: 'hover:border-[#86EFAC]/60 hover:shadow-lg',
	Reports: 'hover:border-[#CBD5E1]/60 hover:shadow-lg',
	About: 'hover:border-[#99F6E4]/60 hover:shadow-lg',
	Updates: 'hover:border-[#DDD6FE]/60 hover:shadow-lg'
}

const getContentHref = (item: any) => {
	if (item.collection === 'blog') return `/post/${item.slug}`
	return `/${item.collection}/${item.slug}`
}
---

<BaseLayout
	title='Home'
	description='EDI McGill - Promoting Equity, Diversity, and Inclusion at McGill University'
>
	<!-- 1. HERO SECTION - Clear Orientation -->
	<section class='hero-section mb-6 -mx-5 sm:-mx-8 lg:-mx-16 xl:-mx-24'>
		<!-- Hero container with improved grey shadows - expanded horizontally and taller -->
		<div
			class='relative w-full h-[500px] md:h-[550px] lg:h-[600px] overflow-hidden shadow-[0_20px_60px_-15px_rgba(100,100,100,0.35),0_10px_30px_-10px_rgba(100,100,100,0.25)] dark:shadow-[0_20px_60px_-15px_rgba(80,80,80,0.5),0_10px_30px_-10px_rgba(80,80,80,0.4)] border-y border-gray-300/20 dark:border-gray-600/30'
		>
			<!-- Background image - kept as background, not foreground -->
			<Image
				src={bannerImage}
				alt='EDI McGill - Diversity and Inclusion'
				class='w-full h-full object-cover opacity-15'
				width={1200}
				height={600}
			/>

			<!-- Subtle overlay to blend image with background -->
			<div
				class='absolute inset-0 bg-gradient-to-r from-blue-900/20 via-purple-900/15 to-transparent dark:from-blue-950/30 dark:via-purple-950/20'
			>
			</div>

			<!-- Content positioning layer - positioned lower in the hero -->
			<div class='absolute inset-0 flex items-center justify-start px-4 md:px-8 pt-16 md:pt-20'>
				<!-- Semi-transparent panel behind text - more compact vertically -->
				<div
					class='w-full md:w-[55%] lg:w-[52%] bg-white/90 dark:bg-gray-900/90 backdrop-blur-md rounded-2xl p-6 md:p-8 shadow-[0_8px_30px_rgba(100,100,100,0.2)] dark:shadow-[0_8px_30px_rgba(0,0,0,0.4)] border border-gray-200/50 dark:border-gray-700/50'
				>
					<!-- Tertiary: Affiliation badge -->
					<div
						class='mb-3 inline-block bg-[#E0F2FE] dark:bg-[#1E3A8A]/50 px-3 py-1.5 rounded-full text-xs font-medium text-[#0369A1] dark:text-[#93C5FD] border border-[#BAE6FD]/50 dark:border-[#1E40AF]/50'
					>
						A McGill initiative
					</div>

					<!-- Primary: Purpose statement - now the hero -->
					<h1
						class='text-xl md:text-2xl lg:text-3xl font-semibold mb-3 leading-snug text-gray-800 dark:text-gray-100'
					>
						Stories, resources, and conversations for equity in McGill Engineering
					</h1>

					<!-- Secondary: Identity (smaller subheading style) -->
					<p class='text-base md:text-lg mb-3 font-medium text-[#0284C7] dark:text-[#7DD3FC]'>
						EDI McGill
					</p>

					<!-- Supporting text -->
					<p
						class='text-xs md:text-sm mb-5 text-gray-600 dark:text-gray-300 max-w-xl leading-loose'
					>
						We're building an inclusive graduate community where diverse voices are heard, valued,
						and empowered to thrive.
					</p>

					<!-- CTA buttons - vibrant burnt orange primary -->
					<div class='flex flex-wrap gap-3'>
						<a
							href='/participate'
							class='px-6 py-2.5 rounded-xl text-sm font-semibold transition-all'
							style='background: #E05A1A; color: #FFFFFF; box-shadow: 0 6px 20px rgba(224, 90, 26, 0.45);'
							onmouseover="this.style.background='#C94F17'; this.style.boxShadow='0 8px 26px rgba(224, 90, 26, 0.55)';"
							onmouseout="this.style.background='#E05A1A'; this.style.boxShadow='0 6px 20px rgba(224, 90, 26, 0.45)';"
						>
							Get involved
						</a>
						<a
							href='/about'
							class='text-sm font-medium no-underline hover:underline transition-all px-4 py-2.5 rounded-lg hover:bg-[rgba(91,45,139,0.12)]'
							style='color: #5B2D8B; text-decoration-color: rgba(91, 45, 139, 0.3);'
						>
							Learn more
						</a>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- 2. WHAT'S HAPPENING NOW - Updates Preview -->
	<section class='updates-preview mb-6' data-aos='fade-up'>
		<div class='mb-8'>
			<h2 class='text-2xl md:text-3xl font-semibold mb-3 leading-relaxed' style='color: #111827;'>
				Recent updates — see what's relevant to you
			</h2>
			<p class='text-sm leading-loose' style='color: #374151;'>
				Stories, programs, and resources from across our community.
			</p>
		</div>

		{
			recentUpdates.length > 0 ? (
				<div class='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8'>
					{recentUpdates.map((item) => (
						<a
							href={getContentHref(item)}
							class={`group block bg-gradient-to-br ${cardGradients[item.type]} backdrop-blur-sm relative overflow-hidden`}
							style='border-radius: 18px; padding: 24px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); transition: transform 200ms ease-out, box-shadow 200ms ease-out;'
							onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 36px rgba(0, 0, 0, 0.12)';"
							onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 24px rgba(0, 0, 0, 0.08)';"
						>
							<div class='relative z-10'>
								<div class='flex items-center gap-3 mb-4'>
									<span
										class={`px-3 py-1.5 rounded-lg text-xs font-medium ${typeColors[item.type]}`}
									>
										{item.type}
									</span>
									<FormattedDate date={item.data.pubDate} class='text-xs' style='color: #6B7280;' />
								</div>
								<h3
									class='text-lg font-semibold mb-3 transition-colors leading-snug'
									style='color: #1F2937;'
								>
									{item.data.title}
								</h3>
								<p class='text-sm line-clamp-3 leading-relaxed' style='color: #374151;'>
									{item.data.description}
								</p>
							</div>
						</a>
					))}
				</div>
			) : (
				<div class='bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950 dark:to-purple-950 rounded-xl p-12 text-center mb-8'>
					<Rocket
						class='w-16 h-16 mb-4 mx-auto text-blue-600 dark:text-blue-400'
						strokeWidth={1.5}
					/>
					<p class='text-xl text-gray-700 dark:text-gray-300 font-medium'>Updates coming soon!</p>
				</div>
			)
		}
	</section>

	<!-- 3. WHO IS THIS FOR - Vibrant, joyful, warm design -->
	<section
		class='find-your-path mb-6 -mx-5 sm:-mx-8 md:-mx-0 px-5 sm:px-8 md:px-0'
		data-aos='fade-up'
		data-aos-delay='100'
	>
		<div class='bg-white/60 dark:bg-gray-900/20 md:rounded-3xl py-8 md:py-10 px-5 md:px-8'>
			<!-- Orientation -->
			<div class='text-center mb-8 max-w-3xl mx-auto'>
				<h2 class='text-2xl md:text-3xl font-semibold mb-3 leading-relaxed' style='color: #111827;'>
					You might want to explore...
				</h2>
				<p class='text-sm leading-loose' style='color: #374151;'>
					Whether you're a student, staff member, or faculty — there's a place for you. You can
					explore more than one.
				</p>
			</div>

			<!-- Role Cards - Cohesive Card DNA (18px radius, 24px padding, consistent shadow) -->
			<div class='grid grid-cols-1 md:grid-cols-3 gap-6 mb-8'>
				<!-- Students - Royal Purple (resources, learning, stories) -->
				<div
					class='group relative block'
					style='border-radius: 18px; padding: 1.5px; background: linear-gradient(135deg, rgba(91, 45, 139, 0.24), rgba(91, 45, 139, 0.14)); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); transition: transform 200ms ease-out, box-shadow 200ms ease-out;'
					onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 36px rgba(0, 0, 0, 0.12)';"
					onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 24px rgba(0, 0, 0, 0.08)';"
				>
					<div style='border-radius: 16px; padding: 24px; background: rgba(255, 255, 255, 0.65);'>
						<div class='flex items-start gap-3 mb-4'>
							<GraduationCap
								class='w-5 h-5 flex-shrink-0 mt-0.5'
								style='color: #5B2D8B;'
								strokeWidth={1.5}
							/>
							<div>
								<h3 class='text-lg font-semibold mb-1.5' style='color: #1F2937;'>Students</h3>
								<p class='text-xs leading-loose' style='color: #374151;'>
									Resources and community for your journey
								</p>
							</div>
						</div>
						<ul class='space-y-2.5 text-xs'>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #5B2D8B;'>→</span>
								<a
									href='/resources'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(91, 45, 139, 0.3);'
									>Student support resources</a
								>
							</li>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #5B2D8B;'>→</span>
								<a
									href='/programs'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(91, 45, 139, 0.3);'
									>Upcoming workshops</a
								>
							</li>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #5B2D8B;'>→</span>
								<a
									href='/stories'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(91, 45, 139, 0.3);'
									>Share your story</a
								>
							</li>
						</ul>
					</div>
				</div>

				<!-- Staff - Burnt Orange (events, workshops, calls to action) -->
				<div
					class='group relative block'
					style='border-radius: 18px; padding: 1.5px; background: linear-gradient(135deg, rgba(224, 90, 26, 0.26), rgba(224, 90, 26, 0.16)); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); transition: transform 200ms ease-out, box-shadow 200ms ease-out;'
					onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 36px rgba(0, 0, 0, 0.12)';"
					onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 24px rgba(0, 0, 0, 0.08)';"
				>
					<div style='border-radius: 16px; padding: 24px; background: rgba(255, 255, 255, 0.65);'>
						<div class='flex items-start gap-3 mb-4'>
							<Users
								class='w-5 h-5 flex-shrink-0 mt-0.5'
								style='color: #E05A1A;'
								strokeWidth={1.5}
							/>
							<div>
								<h3 class='text-lg font-semibold mb-1.5' style='color: #1F2937;'>Staff</h3>
								<p class='text-xs leading-loose' style='color: #374151;'>
									Tools and training for inclusive practices
								</p>
							</div>
						</div>
						<ul class='space-y-2.5 text-xs'>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #E05A1A;'>→</span>
								<a
									href='/resources'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(224, 90, 26, 0.3);'
									>EDI toolkits & guides</a
								>
							</li>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #E05A1A;'>→</span>
								<a
									href='/resources'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(224, 90, 26, 0.3);'
									>Professional development</a
								>
							</li>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #E05A1A;'>→</span>
								<a
									href='/participate'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(224, 90, 26, 0.3);'
									>Get involved</a
								>
							</li>
						</ul>
					</div>
				</div>

				<!-- Faculty & Leadership - Golden Yellow (belonging, community, wins) -->
				<div
					class='group relative block'
					style='border-radius: 18px; padding: 1.5px; background: linear-gradient(135deg, rgba(242, 201, 76, 0.30), rgba(242, 201, 76, 0.18)); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); transition: transform 200ms ease-out, box-shadow 200ms ease-out;'
					onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 36px rgba(0, 0, 0, 0.12)';"
					onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 24px rgba(0, 0, 0, 0.08)';"
				>
					<div style='border-radius: 16px; padding: 24px; background: rgba(255, 255, 255, 0.65);'>
						<div class='flex items-start gap-3 mb-4'>
							<Target
								class='w-5 h-5 flex-shrink-0 mt-0.5'
								style='color: #F2C94C;'
								strokeWidth={1.5}
							/>
							<div>
								<h3 class='text-lg font-semibold mb-1.5' style='color: #1F2937;'>
									Faculty & Leadership
								</h3>
								<p class='text-xs leading-loose' style='color: #374151;'>
									Research and strategic initiatives
								</p>
							</div>
						</div>
						<ul class='space-y-2.5 text-xs'>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #F2C94C;'>→</span>
								<a
									href='/reports'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(242, 201, 76, 0.3);'
									>EDI reports & data</a
								>
							</li>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #F2C94C;'>→</span>
								<a
									href='/about'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(242, 201, 76, 0.3);'
									>Our approach</a
								>
							</li>
							<li class='flex items-center' style='color: #374151;'>
								<span class='mr-2 text-sm' style='color: #F2C94C;'>→</span>
								<a
									href='/resources'
									class='hover:underline'
									style='color: #374151; text-decoration-color: rgba(242, 201, 76, 0.3);'
									>Leadership training</a
								>
							</li>
						</ul>
					</div>
				</div>
			</div>

			<!-- Case Studies - Royal Purple playcard with cohesive DNA -->
			<div class='max-w-6xl mx-auto'>
				<a
					href='/participate'
					class='group block cursor-pointer'
					style='border-radius: 18px; padding: 1.5px; background: linear-gradient(135deg, rgba(91, 45, 139, 0.18), rgba(91, 45, 139, 0.10)); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); transition: transform 200ms ease-out, box-shadow 200ms ease-out;'
					onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 36px rgba(0, 0, 0, 0.12)';"
					onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 24px rgba(0, 0, 0, 0.08)';"
				>
					<div style='border-radius: 16px; padding: 24px; background: rgba(255, 255, 255, 0.65);'>
						<div class='flex flex-col md:flex-row items-start justify-between gap-4'>
							<div class='flex-1'>
								<p class='text-xs font-medium mb-2' style='color: #6B7280;'>When you're ready...</p>
								<h3
									class='text-base md:text-lg font-semibold mb-2 leading-relaxed'
									style='color: #1F2937;'
								>
									Explore real EDI case studies
								</h3>
								<p class='text-sm leading-loose' style='color: #374151;'>
									Interactive scenarios to understand EDI challenges and solutions in real-world
									contexts
								</p>
							</div>
							<div class='flex-shrink-0 mt-2 md:mt-0 self-start md:self-center'>
								<span
									class='text-sm font-medium no-underline hover:underline transition-all'
									style='color: #5B2D8B; text-decoration-color: rgba(91, 45, 139, 0.3);'
								>
									Explore case studies →
								</span>
							</div>
						</div>
					</div>
				</a>
			</div>
		</div>
	</section>

	<!-- 4. SUPPORT SECTION - Warm & Editorial -->
	<section class='support-strip mb-6' data-aos='fade-up'>
		<div
			class='bg-[#FFF8F0] dark:bg-[#2B2520] rounded-2xl p-8 md:p-10 border border-[#F5E6D3]/50 dark:border-[#3D3530]/50'
		>
			<div class='flex flex-col md:flex-row items-start justify-between gap-6'>
				<div class='flex items-start gap-3 flex-1'>
					<HandHeart
						class='w-5 h-5 text-gray-600 dark:text-gray-400 flex-shrink-0 mt-1'
						strokeWidth={1.5}
					/>
					<div>
						<h3
							class='text-xl md:text-2xl font-semibold mb-2 text-gray-800 dark:text-gray-200 leading-snug'
						>
							You don't have to navigate this alone
						</h3>
						<p class='text-gray-600 dark:text-gray-400 text-base leading-relaxed'>
							Support and accommodations are available.
						</p>
					</div>
				</div>
				<div class='flex flex-col md:flex-row gap-3 md:items-center md:ml-auto'>
					<a
						href='/resources'
						class='bg-[#E8D5C4] dark:bg-[#4A3F35] text-gray-800 dark:text-gray-200 px-6 py-2.5 rounded-lg font-semibold text-sm hover:bg-[#DCC5B0] dark:hover:bg-[#5A4F45] transition-all'
					>
						Get support
					</a>
					<a
						href='/resources'
						class='text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 text-sm font-medium transition-colors underline decoration-gray-400 hover:decoration-gray-600'
					>
						Browse resources
					</a>
				</div>
			</div>
		</div>
	</section>
</BaseLayout>

<script>
	// Initialize AOS (Animate On Scroll)
	import AOS from 'aos'

	document.addEventListener('DOMContentLoaded', () => {
		AOS.init({
			duration: 800,
			easing: 'ease-in-out',
			once: true,
			offset: 100
		})
	})
</script>

<style>
	.line-clamp-2 {
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.line-clamp-3 {
		display: -webkit-box;
		-webkit-line-clamp: 3;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	/* Case Study Tabs */
	.case-study-tab {
		color: #6b7280;
		background: transparent;
	}

	.case-study-tab.active {
		background: white;
		color: #14b8a6;
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
	}

	.dark .case-study-tab.active {
		background: #1f2937;
		color: #5eead4;
	}

	/* Case Study Content */
	.case-study-content {
		display: none;
		animation: fadeIn 0.3s ease-in;
	}

	.case-study-content.active {
		display: block;
	}

	@keyframes fadeIn {
		from {
			opacity: 0;
			transform: translateY(10px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	/* Accordion */
	.accordion-content {
		max-height: 0;
		overflow: hidden;
		transition: max-height 0.3s ease;
	}

	.accordion-content.active {
		max-height: 500px;
	}

	.accordion-icon {
		transition: transform 0.3s ease;
	}

	.accordion-trigger.active .accordion-icon {
		transform: rotate(45deg);
	}

	/* Progress Bars */
	.progress-bar {
		transition: width 1.5s ease-out;
	}
</style>

<script>
	// Tab Switching
	document.addEventListener('DOMContentLoaded', () => {
		const tabs = document.querySelectorAll('.case-study-tab')
		const contents = document.querySelectorAll('.case-study-content')

		tabs.forEach((tab) => {
			tab.addEventListener('click', () => {
				const targetTab = tab.dataset.tab

				// Remove active from all tabs and contents
				tabs.forEach((t) => {
					t.classList.remove('active')
					t.setAttribute('aria-selected', 'false')
				})
				contents.forEach((c) => c.classList.remove('active'))

				// Add active to clicked tab and corresponding content
				tab.classList.add('active')
				tab.setAttribute('aria-selected', 'true')
				document.getElementById(`${targetTab}-content`).classList.add('active')

				// Animate progress bars when tab becomes active
				animateProgressBars()
			})
		})

		// Accordion Functionality
		const accordionTriggers = document.querySelectorAll('.accordion-trigger')

		accordionTriggers.forEach((trigger) => {
			trigger.addEventListener('click', () => {
				const content = trigger.nextElementSibling
				const isActive = content.classList.contains('active')

				// Close all accordions in the same group
				const parent = trigger.closest('.case-study-content')
				if (parent) {
					parent.querySelectorAll('.accordion-content').forEach((c) => {
						c.classList.remove('active')
					})
					parent.querySelectorAll('.accordion-trigger').forEach((t) => {
						t.classList.remove('active')
					})
				}

				// Toggle current accordion
				if (!isActive) {
					content.classList.add('active')
					trigger.classList.add('active')
				}
			})
		})

		// Progress Bar Animation
		function animateProgressBars() {
			const activeContent = document.querySelector('.case-study-content.active')
			if (activeContent) {
				const progressBars = activeContent.querySelectorAll('.progress-bar')
				progressBars.forEach((bar) => {
					const progress = bar.dataset.progress
					setTimeout(() => {
						bar.style.width = progress + '%'
					}, 100)
				})
			}
		}

		// Intersection Observer for scroll-triggered animations
		const observer = new IntersectionObserver(
			(entries) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						animateProgressBars()
					}
				})
			},
			{ threshold: 0.5 }
		)

		const caseStudiesSection = document.querySelector('.case-studies')
		if (caseStudiesSection) {
			observer.observe(caseStudiesSection)
		}

		// Initial animation
		animateProgressBars()
	})
</script>
