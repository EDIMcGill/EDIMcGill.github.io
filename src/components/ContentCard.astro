---
/**
 * ContentCard Component
 *
 * Universal card component for all content types (events, stories, resources, reports)
 * Used in the Updates feed and collection listing pages
 */
import { Image } from 'astro:assets'
import FormattedDate from './FormattedDate.astro'
import Tag from './Tag.astro'
import type { CollectionEntry } from 'astro:content'

interface Props {
	content:
		| CollectionEntry<'events'>
		| CollectionEntry<'stories'>
		| CollectionEntry<'resources'>
		| CollectionEntry<'reports'>
	contentType: 'events' | 'stories' | 'resources' | 'reports'
	href: string
}

const { content, contentType, href } = Astro.props
const { title, description, pubDate, heroImage, tags, pinned } = content.data

// Map content type to badge color
const badgeColors = {
	events: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
	stories: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
	resources: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
	reports: 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200'
}

const badgeLabels = {
	events: 'Event',
	stories: 'Story',
	resources: 'Resource',
	reports: 'Report'
}
---

<article
	class='content-card group relative flex flex-col h-full border-2 border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden hover:border-blue-500 dark:hover:border-blue-400 transition-all duration-300 hover:shadow-lg'
	data-content-type={contentType}
>
	{
		pinned && (
			<div class='absolute top-2 left-2 z-10 bg-yellow-400 text-yellow-900 px-2 py-1 rounded text-xs font-bold'>
				ðŸ“Œ Pinned
			</div>
		)
	}

	<a href={href} class='block flex-shrink-0'>
		<div class='relative w-full h-48 overflow-hidden bg-gray-200 dark:bg-gray-800'>
			<Image
				src={heroImage}
				alt={title}
				class='w-full h-full object-cover group-hover:scale-105 transition-transform duration-300'
				width={400}
				height={200}
			/>
		</div>
	</a>

	<div class='flex-1 flex flex-col p-5'>
		<div class='flex items-center gap-3 mb-3'>
			<span class={`px-3 py-1 rounded-full text-xs font-semibold ${badgeColors[contentType]}`}>
				{badgeLabels[contentType]}
			</span>
			<FormattedDate date={pubDate} />
		</div>

		<a href={href} class='block mb-2'>
			<h3
				class='text-xl font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors'
			>
				{title}
			</h3>
		</a>

		<p class='text-gray-600 dark:text-gray-300 text-sm mb-4 flex-1'>
			{description}
		</p>

		{
			tags && tags.length > 0 && (
				<div class='flex flex-wrap gap-2 mt-auto'>
					{tags.slice(0, 3).map((tag) => (
						<Tag tag={tag} />
					))}
					{tags.length > 3 && (
						<span class='text-xs text-gray-500 dark:text-gray-400'>+{tags.length - 3} more</span>
					)}
				</div>
			)
		}
	</div>
</article>
